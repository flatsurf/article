\documentclass{article}

\usepackage{amsmath,amssymb}
\usepackage{graphicx,subcaption}
\usepackage{url}
\usepackage[margin=2cm]{geometry}
\usepackage[abbreviations]{foreign}
\usepackage{xcolor}

\def\RR{\mathbb{R}}
\def\CC{\mathbb{C}}

\def\cA{\mathcal{A}}
\def\cE{\mathcal{E}}

\def\Re{\operatorname{Re}}
\def\Im{\operatorname{Im}}
\def\Sym{\operatorname{Sym}}

\newtheorem{definition}{Definition}
\newtheorem{remark}[definition]{Remark}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{theorem}[definition]{Theorem}

\title{Algorithms for translation surfaces}
\author{Vincent Delecroix for Julian R\"uth}

\newcommand{\commv}[1]{{\color{red!50!gray}{#1}}}	

\begin{document}
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Topology and combinatorial maps}
\label{sec:TriangulationsAndTranslationStructures}
We describe how cell decomposition of surfaces can be efficiently encoded by
a triple of permutations. A more detailed description can be found in
\cite[Section 1.3.1 "Graphs versus Maps"]{LandoZvonkin}.

A cell decomposition of a surface can be encoded by a triple of
permutations.
\begin{definition}
Let $\cE$ be a finite set.
A \emph{combinatorial map} or a \emph{fat graph} on $\cE$ is a triple
of permutations $(\sigma, \alpha, \phi) \in \Sym(\cE)^3$ on
the set $\cE$ such that
\begin{enumerate}
\item $\phi \circ \alpha \circ \sigma = id_\cE$,
\item $\alpha$ is an involution without fixed points,
\item the group generated by $\sigma, \alpha, \phi$ acts transitively on $\cE$.
\end{enumerate}
\end{definition}
In the definition the greek letters  $\sigma$, $\alpha$ and $\phi$ respectively stand
for sommet (french for vertices), ar\^etes (edges) and faces. This notation is borrowed
from~\cite{LandoZvonkin}. Each cycle of the cycle
decomposition of $\sigma$, $\alpha$ and $\phi$ represents respectively a vertex, an edge
and a face of the cell decomposition. In particular, the cardinality of $\cE$
is even. The transitivity of the group ensures the connectivity of the surface.
The set $\cE$ can be identified with half edges or oriented edges.

\begin{remark}
The notion of 3-constellation introduced in~\cite{LandoZvonkin} is more general as it
avoids item 2: $\alpha$ can be any permutation.
\end{remark}

If $g$ is a permutation we denote $c(g)$ the number of cycles of the permutation $g$.
The numbers $c(\sigma)$, $c(\alpha)$ and $c(\phi)$ are respectively the number of vertices,
edges and faces of the combinatorial map $(\sigma, \alpha, \phi)$.

A particular case of combinatorial maps are \emph{triangulations}
when the permutation $\phi$ is a product of disjoint 3-cycles.
In these situation $\# \cE$ is a multiple of $6$.

\begin{figure}[!ht]
\begin{minipage}{0.4\textwidth}
\begin{center}
\includegraphics{pictures/Torus.pdf}
\subcaption{A square torus $\sigma = (0,1,2,3)$, $\alpha=(0,2)(1,3)$, $\phi=(0,1,2,3)$.}
\end{center}
\end{minipage}
\hspace{0.1\textwidth}
\begin{minipage}{0.4\textwidth}
\begin{center}
\includegraphics{pictures/TriangulatedTorus.pdf}
\subcaption{A triangulated torus $\sigma = (0,4,1,2,5,3)$, $\alpha=(0,2)(1,3)(4,5)$, $\phi=(0,1,5)(2,3,4)$.}
\end{center}
\end{minipage}
\caption{Examples of combinatorial maps on a torus.}
\label{fig:CombinatorialMapTori}
\end{figure}


The \emph{dual} of the combinatorial map $(\sigma, \alpha, \phi)$ is the combinatorial
map $(\phi^{-1}, \alpha, \sigma^{-1})$.
\begin{figure}[!ht]
\begin{center}
\includegraphics{pictures/DualCombinatorialMaps.pdf}
\end{center}
\caption{Dual combinatorial maps}
\label{fig:DualCombinatorialMaps}
\end{figure}

Figure~\ref{fig:DualCombinatorialMaps} provides a local picture of two dual
combinatorial maps.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Elementary moves: removing, adding, flipping edges}
\label{sec:ElementaryMoves}
Let $(\sigma, \alpha, \phi)$ be a combinatorial map on $\cE$. We define three operations
(and their inverses) that allow to move through the space of all combinatorial maps of given genus.

\subsection{Removing edges / splitting faces}
\noindent\textbf{removing an edge}:
Let $(x,y)$ be a transposition of $\alpha$ such that the two faces adjacent to this
edge are different then we can remove this edge and obtain a new combinatorial map.
\begin{center}\includegraphics{pictures/RemoveEdge.pdf}\end{center}
The operation on the permutations is given as follows
\begin{align*}
\sigma = (j,x,A) (i,y,B) \ldots & \mapsto (j,A) (i,B) \ldots \\
\alpha = (j, \alpha(j)) (i, \alpha(i)) (x,y) \ldots & \mapsto (j, \alpha(j)) (i, \alpha(i)) \ldots \\
\phi = (x,i,C) (y,j,D) \ldots & \mapsto (i,C,j,D) \ldots 
\end{align*} 
This operation merges the two faces adjacent to the edge $(x,y)$ into a single bigger face.
The new combinatorial map is on the set $\cE \setminus \{x,y\}$.

\noindent\textbf{splitting a face}:
This is simply the reverse procedure of removing an edge.

\subsection{Contracting edges / splitting vertices}
\noindent\textbf{contracting an edge}:
dual to "removing an edge"

\noindent\textbf{splitting a vertex}:
reverse to the above.

\subsection{Forward flip / backward flip}
The operation considered above modifies the number of edges of the combinatorial map.

\noindent\textbf{forward edge flip in a face}
\begin{center}\includegraphics{pictures/FlipEdge.pdf}\end{center}
Given an edge $(x,y)$ that is adjacent to distinct faces, we can perform an
"edge flip" as in the above figure.
The flip operation does neither changes the underlying set $\cE$ nor the size of the faces.

\smallskip

\noindent\textbf{forward edge flip at a vertex} there is a dual operation that consists in
performing a flip "around two vertices" instead of "at the junction of two faces".

\bigskip

\section{Translation structures}
\begin{definition}
\label{def:FlatTriangulation}
Let $T = (\sigma, \alpha, \phi) \in \Sym(\cE)^3$ be a 
triangulation, a \emph{translation structure} on $T$
is a family of non-zero complex numbers $\{\zeta_i\}_{i\in\cE}$
such that
\begin{enumerate}
\item for each cycle $(i,j)$ of $\alpha$ we have $\zeta_i + \zeta_j = 0$
\item for each cycle $(i_1,i_2,i_3)$ of $\phi$ 
the vectors $\zeta_{i_1}$, $\zeta_{i_2}$, $\zeta_{i_3}$ form the
sides of a triangle in $\CC$ where the sides appear in counter-clockwise order
(in particular $\zeta_{i_1} + \zeta_{i_2} + \zeta_{i_3} = 0$).
\end{enumerate}
\end{definition}
A translation surface is a geometrical notion and using triangulations
and the above definition is very often not enough.
For example in~\cite{veerer}, we need a more restrictive version
(related to the slopes of the vectors $\zeta_i$).
On the other hand, one might want to generalize translation structures
to cell decompositions that are not triangulations.
For now, let us consider a simple definition that is not the most
general possible but which is simple to state.
\begin{definition}
\label{def:EmbeddedTranslationStructure}
Let $M = (\sigma, \alpha, \phi) \in \Sym(\cE)$ be a combinatorial
map. An \emph{embedded translation structure} for $M$ is a zet of non-zero
complex numbers $\{\zeta_i\}_{i=1,\ldots,2n}$ such that
\begin{enumerate}
\item for each cycle $(i,j)$ of $\alpha$ we have $\zeta_i + \zeta_j = 0$
\item for each cycle $(i_1,i_2,\ldots,i_k)$ of $\phi$ the vectors
$\zeta_{i_1}$, \ldots, $\zeta_{i_k}$ form the sides of a $k$-gon in
$\CC$ where the vectors appear in counter-clockwise order.
\end{enumerate}
\end{definition}

A \emph{sub-translation structure} is one that can be obtained by forgetting
some edges (see also Section~\ref{sec:ElementaryMoves}. Because a polygon can
always be triangulated we have the following.
\begin{lemma}
Given a combinatorial map endowed with translation structure $(M,\zeta)$, there
exists a triangulation with a translation structure $(T,\zeta')$ so that $M$ is
a sub-translation structure of $(T,\zeta')$.
\end{lemma}

\subsection{Elementary moves on translation structures}
Given a combinatorial map endowed with a translation structure $(M, \zeta)$
we want to extend the elementary moves of Section~\ref{sec:ElementaryMoves}
that were operating on $M$ to the pair $(M, \zeta)$. The geometry of $\zeta$
forbids certain moves to happend.

\textbf{removing an edge / splitting a face}
Removing an edge might result in a non-embedded translation structure.
Splitting a face is always possible.

\textbf{contracting an edge / splitting a vertex}
Operations not allowed.

\textbf{forward flip / backward flip}
To perform a flip, the new edge to be added must be contained in the union of
the two faces (or in other words a saddle connection on the translation surface).
In the special cases the two adjacent faces are triangles, the condition
for flipping the edge (which is one diagonal of the quadrilateral) is that the
quadrilateral is convex.
\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/QuadrilateralFlip.pdf}\end{center}
\caption{A flip in a quadrilateral.}
\end{figure}

\subsection{Delaunay triangulations and isomorphism checking}
From a translation structure on a triangulation one can compute a canonical
cell decomposition of the surface called the $\ell^2$-Delaunay decomposition.
It allows for example to solve the isomorphism problem: given two
translation surfaces given as pairs $(M,\zeta)$ and $(M',\zeta')$ are
the underlying translation surface isomorphic.

It is also possible to consider the $\ell^\infty$-Delaunay decomposition
which is very much relevant when we want to study the translation flows
in a translation surface.

\commv{These are (simple enough) but essential algorithm.
\begin{enumerate}
\item TODO: implement $\ell^2$-Delaunay, isomorphism checking and isometry group,
\item TODO: implement $\ell^\infty$-Delaunay.
\end{enumerate}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{From translation structures to interval exchange transformation}
Given a translation surface we want to study the behavior of its vertical foliations
(the foliation in any direction is relevant, but since the surface can be rotated,
we assume that we deal with the vertical). The information about the vertical
foliation can be encoded in a one-dimensional object: an interval exchange
transformation or more generally a weight on a train track.
The aim of this section is to describe an algorithm that starts from a
flat triangulation and produces an interval exchange map that encodes
the vertical foliation.

\subsection{Interval exchange transformations}
As with translation structures, interval exchange transformations are described
by a combinatorial and a continous data. More precisely by 
a pair $(\pi, \lambda)$ where $\pi$ is a combinatorial data and $\lambda$ is
a continuous data.

An interval exchange is easily describe in words. Consider the interval
$I = [0,1]$. Cut it into finitely many open sub-intervals
$I_1^{top} = (0,x_1^{top})$, $I_2^{top} = (x_1^{top}, x_2^{top})$, \ldots,
$I_d^{top} = (x_{d-1}^{top}, 1)$. Rearrange the $d$ interval using a fixed
permutation $\pi$ provide a map on $[0,1]$ which is a piecewise translation.
This map is an interval exchange transformation.

\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/MultiIET.pdf}\end{center}
\caption{An interval exchange transformation with $\cE^{top} = \{a,b,c,d\}$,
$\cE^{bot} = \{a',b',c',d'\}$ and $\alpha = (a,a')(b,b')(c,c')(d,d')$.
The interval exchange maps the sub-interval $I_a$ to $I_{a'}$ by
translation and similarly for the other sub-intervals.}
\label{fig:MultiIET}
\end{figure}

Let us turn to the formal definition of interval exchange transformations
We first describe the combinatorial part that we call permutation. Our definition
differs slightly from~\cite{Yoccoz} since our aim is to make clear the relation
with combinatorial maps and flat triangulations.
\begin{definition}
A \emph{permutation} on a finite set $\cE$ of cardinality $2d$, is a combinatorial
map $(\sigma, \alpha, \phi)$ together with a set partition $\cE = \cE^{top} \cup \cE^{bot}$
such that $\phi$ is a $2d$ cycle and both $\alpha$ and $\phi^d$ exchanges
$\cE^{top}$ with $\cE^{bot}$.
\end{definition}
On the example of Figure~\ref{fig:MultiIET} the permutation
\[
\left(\begin{array}{c}
a\ b\ c\ d \\
c'\ b'\ d'\ a' \\
\end{array} \right)
\]
corresponds to the combinatorial map
\begin{align*}
\alpha &= (a\ a')(b\ b')(c\ c')(d\ d') \\
\phi &= (c'\ b'\ d'\ a'\ d\ c\ b\ a)
\end{align*}
and the atoms $\cE^{top} = \{a,b,c,d\}$ and $\cE^{bot} = \{a',b',c',d'\}$.

A \emph{length data} for a permutation $\pi = (\sigma, \alpha, \phi, \cE^{top}, \cE^{bot})$
is a vector $\lambda \in \RR_{>0}^\cE$ such that $\lambda_{\alpha(e)} = \lambda_e$ for each
$e \in \cE$.

\begin{definition}
Let $\pi = (\sigma, \alpha, \phi, \cE^{top}, \cE^{bot})$ be a permutation
on $\cE$ and $\lambda \in \RR_{>0}^\cE$ be a length data.

The \emph{interval exchange transformation} associated to the pair $(\pi,\lambda)$
is the partial transformation on $I = [0, |\lambda|]$
as in Figure~\ref{fig:MultiIET} where the lengths of the subintervals are specified
by the length data.
\end{definition}

%\begin{remark}
%An alternative definition of multi-permutation is to consider an alphabet $\cA$
%with $\# \cA = \frac{1}{2} \# \cE$ that is in bijection with the orbits of
%$\alpha$. That is we have bijections $p^{top}: \cA \to \cE^{top}$ and
%$p^{bot}: \cA \to \cE^{bot}$ so that $\alpha \circ p^{top} = p^{bot}$.
%The definition we used with $(\cE, \alpha)$ is more reminiscent of
%the combinatorial map that we previously introduced. The definition with the set
%$\cA$ is used in~\cite{Yoccoz} to define iet (but he does not discuss multi-iet).
%\end{remark}

\subsection{From flat triangulation to interval exchange transformation}
Given a flat triangulation we distinguish four types of triangles.
\begin{figure}[!ht]\begin{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{minipage}{0.4\textwidth}
\begin{center}\includegraphics{pictures/ForwardTriangle.pdf}\end{center}
\subcaption{Forward triangle with its wide edge thicker.}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hspace{0.1\textwidth}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{minipage}{0.4\textwidth}
\begin{center}\includegraphics{pictures/BackwardTriangle.pdf}\end{center}
\subcaption{Backward triangle with its wide edge thicker.}
\end{minipage} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{minipage}{0.4\textwidth}
\begin{center}\includegraphics{pictures/VerticalLeftTriangle.pdf}\end{center}
\subcaption{Left vertical triangle (non vertical edges have same width).}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hspace{0.1\textwidth}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{minipage}{0.4\textwidth}
\begin{center}\includegraphics{pictures/VerticalRightTriangle.pdf}\end{center}
\subcaption{Right vertical triangle (non vertical edges have same width).}
\end{minipage}
\caption{The four types of flat triangles.}
\end{center}\end{figure}
\begin{lemma}
Let $T$ be a flat triangulation.
\begin{itemize}
\item Each triangle in $T$ is exactly of one type among forward, backward, left vertical or right vertical.
\item The number of left vertical triangles is equal to the number of right vertical triangles. More precisely, each vertical
edge has a left vertical triangle on its left and a right vertical triangle on its right.
\item The number of forward triangles is equal to the number of backward triangles.
\end{itemize}
\end{lemma}

\begin{definition}
An edge of a flat triangulation is called
\begin{itemize}
\item \emph{large} if it is the wide edge of both of its adjacent triangles (in this case
the triangle on top is backward and the triangle in the bottom is forward) or if it is the
wide edge of a triangle and its other neighboring triangle is vertical,
\item \emph{small} if it is vertical or it is the wide edge in neither of its adjacent triangles (in this latter case the triangle on top is forward and the triangle in the bottom is backward),
\end{itemize}
\end{definition}
Note that large, small and vertical are exclusive properties of edges but do
not cover all cases.

In a flat triangulation, it is always possible to flip a large edge. A
\emph{forward flip} is a flip of a large edge. After a forward flip, the large
edge becomes small. See Figure~\ref{fig:ForwardFlip}
\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/QuadrilateralFlip2.pdf}\end{center}
\caption{A forward flip.}
\label{fig:ForwardFlip}
\end{figure}

% with a single purple (0):
% VeeringTriangulation("(0,~2,1)(2,~6,~3)(3,5,~4)(4,8,~5)(6,~8,~7)(7,~1,~0)", "PRBRRBBBR")

% with two purple (0 and 5)
% VeeringTriangulation("(0,~7,6)(1,~5,~2)(2,4,~3)(3,8,~4)(5,7,~6)(~8,~1,~0)", "PRBRBPRBB")

Given a large edge $e$ in a triangulation we construct a pair of connected sets
of triangles organized in form of a binary tree. The root of the top tree
$T_{top}$ is the triangle on top of the wide edge. Then we construct
recursively the tree by adding an edge $t \to t'$ between a triangle $t$
already in our tree and $t'$ if $t'$ is a backward triangle adjacent to $t$.
An example is provided in Figure~\ref{fig:TopTree}.
\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/WideEdgeBinaryTree.pdf}\end{center}
\caption{The top binary tree (in blue) of a wide edge $e_0$. The top contour that consists
of the half edges $\{a_i\}_{i=1,\ldots,6}$ is coloured. Below the picture we draw the
projection of the real parts of the edges that correspond to "half" of an interval
exchange transformation.}
\label{fig:TopTree}
\end{figure}
Similarly, we construct a bottom tree $T_{bot}$ starting from the
triangle in the bottom of $e$ and gluing all forward triangles connected
to it.

\begin{lemma}
Let $T$ be a flat triangulation without vertical edges.
Then the set of bottom and top trees attached to large edges 
form a partition of the triangles of $T$.

If moreover there is a single large edge in $T$, then the top contour
of the top tree and the bottom contour of the bottom tree form an interval exchange
transformation where the widths of the sub-intervals are given by the
real parts of these edges.
\end{lemma}

\textbf{Algorithm (assuming we do not encounter vertical edges):}
\begin{enumerate}
\item Fix a large edge $e_1$ in the triangulation $T$.
\item while there is another large edge $e' \not= e_1$ flip it
\end{enumerate}

In the case where there is a vertical saddle connection we also
flip large edges as in Figure~\ref{fig:ForwardFlipWithVertical}.
\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/ForwardFlipWithVertical.pdf}\end{center}
\caption{A sequence of forward flip through a family of vertical triangles.}
\label{fig:ForwardFlipWithVertical}
\end{figure}
Though, we need to add one more check in the algorithm since vertical saddle
connections are never flipped and might disconnect the surface, see Figure~\ref{fig:VerticalDisconnecting}.
\begin{figure}[!ht]
\begin{center}\includegraphics{pictures/VerticalDisconnecting.pdf}\end{center}
\caption{The two vertical saddle connections corresponding to the edges $(5,6)$ and $(9,10)$
disconnect the surface.}
\label{fig:VerticalDisconnecting}
\end{figure}

\noindent \textbf{Algorithm}
\begin{itemize}
\item Fix a large edge $e_1$ in the triangulation $T$
\item While there is another large edge $e' \not= e_1$ flip it.
If the new edge after a flip is vertical, check whether the vertical saddle
connections disconnect the surface. If they do, then for each connected component
$i$ which is not a cylinder, choose a large edge $e_1^{(i)}$ for inducing and
run the algorithm independently in each subsurface.
\end{itemize}

\subsection{Dynamical decomposition of interval exchange transformation}

As we have seen an interval exchange transformation is just one way to represent
a translation surface with discrete data. We now explain how to decompose an
interval exchange transformation into periodic and minimal components.

Separatrices are canonically labeled by the interval on their left as in
Figure~\ref{fig:LabellingSeparatricesIET}.
\begin{figure}[!ht]
\begin{center}
\includegraphics{pictures/LabellingSeparatricesIET.pdf}%
\hspace{1cm}%
\includegraphics{pictures/SeparatrixDiagram.pdf}\\
\includegraphics{pictures/LabellingSeparatricesIET-2.pdf} \\
\includegraphics{pictures/LabellingSeparatricesIET-3.pdf} \\
\includegraphics{pictures/LabellingSeparatricesIET-4.pdf}
\end{center}
\caption{Discovering the periodic components of an interval exchange transformation
on five intervals. In the end, we obtain a decomposition made of 3 connections,
a minimal component and a cylinder.}
\label{fig:LabellingSeparatricesIET}
\end{figure}


%\subsection{From triangulations with translation structures to multi-interval exchange transformations}
%Let $M = (\sigma, \alpha, \phi)$ be a triangulation on
%the finite set $\cE$ and $\zeta \in \CC^\cE$ a translation structure for $M$.
%We associate to this pair a multi-interval exchange on
%$n_f$-intervals where $n_f$ is the number of triangles in $M$.
%
%Each triangle $(i,j,k)$ in $M$ can be drawn in the plane and has a left-most and
%a right-most vertex. This decomposes its sides into a top and a bot partition.
%See Figure~\ref{fig:FromTrianglesToIntervals}
%\begin{figure}[!ht]
%\begin{minipage}{0.4\textwidth}
%\begin{center}
%\includegraphics{pictures/TriangleToInterval1.pdf}
%\end{center}
%\end{minipage}
%\hspace{.1\textwidth}
%\begin{minipage}{0.4\textwidth}
%\begin{center}
%\includegraphics{pictures/TriangleToInterval2.pdf}
%\end{center}
%\end{minipage}
%\caption{From a triangle (with its separatrix) to an interval.}
%\label{fig:FromTrianglesToIntervals}
%\end{figure}
%
%Note that the length data of the multi-interval exchange transformation is
%simply the vector of absolute values of real parts of the vectors $\zeta_i$.
%In this correspondence:
%\begin{itemize}
%\item an edge of the combinatorial map is in bijection with a pair of intervals
%$(I^{top}_{j,i}, I^{bot}_{j',i'})$ such that the multi-iet maps $I^{top}_{j,i}$
%to $I^{bot}_{j',i'}$.
%\item the outgoing/incoming vertical separatrices in the translation surface are
%in bijections with the singularities of $T$ respectively $T^{-1}$
%\end{itemize}
%
%\subsection{From multi-iet to iet}
%We already described how a translation structure on a triangulation gave rise to a
%multi-iet. We now explain how to reduce a multi-iet to an iet, that is
%a multi-iet on a single interval. For that purpose, we use two operations.
%A gluing operation that allows to paste several
%intervals together and an induction very similar to
%Rauzy induction for iet (see~\cite{Yoccoz} for the latter).
%\begin{definition}
%Let
%$\pi = \{(\cE^{top}_j, \pi^{top}_j, \cE^{bot}_j, \pi^{bot}_j\}_{j=1,\ldots,m}\}$
%be a multi-permutation.
%Assume that there are two distinct subintervals $j_1, j_2 \in \{1,\ldots,m\}$ such
%that the bottom right symbol of the interval $j_1$ is paired with the top left
%symbol of the interval $j_2$. That is if $i := (\pi^{bot}_{j_1})^{-1}(d_{j_1}^{bot})$
%and $i' := (\pi^{top}_{j_2})^{-1}(1)$ satisfy $\alpha(i) = i'$.
%
%The \emph{gluing of $j_1$ and $j_2$ along $(i, i')$} is the new multi-permutation
%on $m-1$ intervals obtained by merging the two components $j_1$ and $j_2$ and forget
%about $(i, i'$). If we had
%\[
%\pi_{j_1} = \left( \begin{array}{c}
%A_1 \\
%B_1\ i
%\end{array} \right)
%\qquad \text{and} \qquad
%\pi_{j_2} = \left( \begin{array}{c}
%i'\ A_2 \\
%B_2 \\
%\end{array} \right)
%\]
%Then the new component after gluing is
%\[
%\left( \begin{array}{c}
%A_1\ A_2 \\
%B_1\ B_2
%\end{array} \right).
%\]
%\end{definition}
%A gluing can be seen on Figure~\ref{fig:MIETGluing}.
%\begin{figure}[!ht]
%\begin{center}\includegraphics{pictures/MultiIETInduction.pdf}\end{center}
%\caption{A gluing operation along $(g,g')$ on a multi-iet.}
%\label{fig:MIETGluing}
%\end{figure}
%
%\begin{definition}
%Let
%$\pi = \{(\cE^{top}_j, \pi^{top}_j, \cE^{bot}_j, \pi^{bot}_j)\}_{j=1,\ldots,m}$
%be a multi-permutation and $\lambda \in \RR_{>0}^{\cE}$ an associated
%length data.
%
%Let $j \in \{1,\ldots,m\}$ and consider the right-most subintervals of
%the $j$-th interval, that is $i^{top} := (\pi^{top}_j)^{-1}(d_j^{top})$
%and $i^{bot} := (\pi^{bot}_j)^{-1}(d_j^{bot})$.
%
%The \emph{right Rauzy induction on the $j$-th component} consists in inducing
%the multi-interval exchange transformation after removing the smallest of
%the two sub-intervals corresponding to $i^{top}$ or $i^{bot}$.
%\end{definition}
%
%\commv{TODO: implement the reduction algorithm that consists in reducing
%a multi-iet to an iet via
%\begin{enumerate}
%\item if a gluing is available, do it
%\item if there is none, perform Rauzy inductions until there is one
%\end{enumerate}}
%
%\subsection{Saddle connections and cylinders}
%The procedure we described so far works if there is no vertical saddle connections.
%When there are, it might be impossible to construct an iet. Even worse, a vertical
%edge is not properly encoded. In this section we discuss how to solve the issues.
%
%\begin{definition}[reducible multi-permutation]
%cumbersome.
%\end{definition}
%
%It might happen that along the inductionPerforming Rauzy induction we detect some saddle connection,
%that is we might have $\lambda_{i^{bot}} = \lambda_{i^{top}}$. In that case, the
%saddle connection should be stored for future use and the two sub-intervals must be
%fusionned. To do that, a fixed labelling of the separatrix has to be chosen at
%the begining.
%
%\subsection{What is a zippered rectangle?}
%\begin{definition}
%\label{def:WeakZipperedRectangle}
%Let $\cE$ be a finite set of cardinality $2d$.
%A \emph{topological zippered rectangle} is a combinatorial map $(\sigma, \alpha, \phi) \in \Sym(\cE)^3$ such that
%\begin{enumerate}
%\item $\phi$ is a $2d$-cycle (that is the cell decomposition consists of a single cell),
%\item there is a partition of $\cE^{top} \cup \cE^{bot} = \cE$ such that the 
%involutions $(\phi)^d$ and $\alpha$ exchanges $\cE^{top}$ and $\cE^{bot}$.
%\end{enumerate}
%A \emph{weak zippered rectangle translation structure} for $(\sigma, \alpha, \phi)$ is
%a set of complex non-zero vectors $\zeta_i$ such that
%\[
%\forall i \in \cE^{bot}, \Re(\zeta_i) \geq 0
%\qquad
%\forall i \in \cE^{top}, \Re(\zeta_i) \leq 0.
%\]
%\end{definition}
%Note that the above definition only involves the real parts of the vectors $\zeta_i$.
%What is missing to make it a zippered rectangle is a condition on imaginary parts
%that correspond the equation $(S_\pi)$ in~\cite{Yoccoz} on the suspension vector. For
%our purpose, this condition is useless and let us ignore it for the moment.
%\begin{figure}[!ht]
%\begin{center}\includegraphics{pictures/MasurPolygon.pdf}\end{center}
%\caption{A zippered rectangle translation structure with combinatorial data
%$\sigma = (0,7,14,1,16,11,4,17)$ or
%$\alpha = (0,16)(1,17)(7,11)(4,14)$ and
%$\phi = (0,1,4,7,16,17,14,11)$. Here $\cE^{top} = \{0,11,14,17\}$ and $\cE^{bot} = \{4,7,16,17\}$. It is depicted as a sub-translation structure of an embedded triangulation.}
%\label{fig:TriangulationYoccoz}
%\end{figure}
%
%The triangulations in Figure~\ref{fig:TriangulationYoccoz} is
%\begin{align*}
%\sigma &= (0,3,6,9,7,5,14,15,1,16,13,10,8,11,12,4,2,17) \\
%\alpha &= (0,16)(1,17)(2,3)(4,14)(5,6)(7,11)(8,9)(10,12)(13,15) \\
%\phi &= (0,1,2)(3,4,5)(6,7,8)(9,10,11)(12,13,14)(15,16,17)
%\end{align*}
%Here is a code sample to it with \cite{surface-dynamics}
%\begin{verbatim}
%sage: from surface_dynamics import FatGraph
%sage: edges = '(0,16)(1,17)(2,3)(4,14)(5,6)(7,11)(8,9)(10,12)(13,15)'
%sage: faces = '(0,1,2)(3,4,5)(6,7,8)(9,10,11)(12,13,14)(15,16,17)'
%sage: FatGraph(ep=edges, fp=faces)
%FatGraph('(0,3,6,9,7,5,14,15,1,16,13,10,8,11,12,4,2,17)',
%'(0,16)(1,17)(2,3)(4,14)(5,6)(7,11)(8,9)(10,12)(13,15)', 
%'(0,1,2)(3,4,5)(6,7,8)(9,10,11)(12,13,14)(15,16,17)')
%\end{verbatim}
%
%Now, given a topological zippered rectangle $(\sigma, \alpha, \phi)$ we describe
%how to construct the bijections $\pi_t:\cA \to \{1,\ldots,d\}$ and $\pi_b: \cA \to \{1,\ldots,d\}$ of~\cite{Yoccoz}.
%Let $\cA$ be the set of the $d$ transpositions that appear in the cycle decomposition
%of $\alpha$ (these are the edges of the combinatorial map). Then by the second
%condition, $\cE^{top}$ and $\cE^{bot}$ are in canonical bijections with $\cA$: to an
%half-edge $i$ associates the unique transposition in $\cA$ that contains $i$.
%Next, there is a unique way to write $\phi$ as
%\[
%\phi = (b_1, b_2, \ldots, b_d, t_d, t_{d-1}, \ldots, t_1)
%\]
%where $\cE^{bot} = \{b_1, \ldots, b_d\}$ and $\cE^{top} = \{t_1, \ldots, t_d\}$.
%Then, for $\alpha = (t_i, b_j) \in \cA$ we set $\pi_t(\alpha) = i$ and $\pi_b(\alpha) = j$.
%
%In the example of Figure~\ref{fig:TriangulationYoccoz}, we have
%\[
%t_1 = 0,\ t_2 = 11,\ t_3 = 14,\ t_4 = 17
%\qquad
%b_1 = 1,\ b_2 = 4,\ b_3 = 7,\ b_4 = 16
%\]
%
%\subsection{Naive version}
%\textit{(discussed on April 22)}
%
%Pick an edge and build the first return map to this edge.
%For that purpose, follow the (vertical) translation flow until it comes back to this edge.
%


%The first step is to build a multi-interval exchange
%transformation out of a triangulation. Each triangle
%will correspond to an interval of the transformation
%and each edge will correspond to a subinterval of the
%transformation.
%
%Each triangle $(a,b,c)$ gives rise of two possible type
%of interval. Either
%\[
%\begin{array}{l}
%b\ a \\
%c
%\end{array}
%\qquad \text{or} \qquad
%\begin{array}{l}
%a \\
%b\ c
%\end{array}
%\]
%We call the first kind bottom-dominant and the second top-dominant.
%
%For each of these intervals, we can forget about the big edge and glue it
%to where it is glued. That diminish the number of intervals under consideration. In
%geometric terms, it corresponds to remove some of the edges of the triangulations.
%
%Another possible bootstrap option: start at a given vertex and look at the horizontal in the right
%direction. We start crossing triangles and we stop at the time we meet a triangle that we already
%encountered. Then remove all edges that are crossed by this horizontal piece. This makes a nice "Masur polygon".
%And we should start again from another vertex until we get rid of all the triangles.
%

\begin{thebibliography}{sage-flatsurf}

\bibitem[sage-flatsurf]{sage-flatsurf}
V. Delecroix, P. Hooper,
\texttt{sage-flatsurf},
\url{https://github.com/videlec/sage-flatsurf}

\bibitem[surface\_dynamics]{surface-dynamics}
V. Delecroix,
\texttt{surface\_dynamics},
\url{https://gitlab.com/videlec/surface_dynamics}

\bibitem[veerer]{veerer}
M. Bell, V. Delecroix, S. Schleimer,
\texttt{veerer},
\url{https://gitlab.com/videlec/veerer}

\bibitem[LaZv03]{LandoZvonkin}
S. Lando and A. Zvonkin
\textit{Graphs on surfaces and their applications}
Springer, (2004).

\bibitem[Yo10]{Yoccoz}
Jean-Christophe Yoccoz
\textit{Interval exchange maps and translation surfaces}
in Homogeneous flows, moduli spaces and arithmetic.
Proceedings of the Clay Mathematics Institute summer school,
(2010).
\end{thebibliography}

\end{document}
